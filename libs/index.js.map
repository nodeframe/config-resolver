{"version":3,"sources":["../src/index.js"],"names":["DEFAULT_ROOT","__dirname","isObject","item","Array","isArray","requireWithDefault","path","default_require","require","e","mergeConfigs","confs","reduce","acc","curr","Object","assign","resolveConfig","conf","keys","map","v","envs","exec","cenvs","value","cf","process","env","toUpperCase","readCommon","dir","readProduction","readDevelopment","module","exports","NODE_ENV"],"mappings":"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","file":"index.js","sourcesContent":["\n\nconst DEFAULT_ROOT = __dirname + \"/./../../../configs\";\n\nfunction isObject (item) {\n  return (typeof item === \"object\" && !Array.isArray(item) && item !== null);\n}\nfunction isArray(item){\n  return Array.isArray(item);\n}\n\nconst requireWithDefault = (path,default_require={})=>{\n  try{\n    return require(path);\n  }catch(e){\n    return default_require;\n  }\n}\n\nconst mergeConfigs = (...confs)=>{\n  return confs.reduce((acc,curr)=>{\n    return Object.assign(acc,curr);\n  },{});\n};\n\nconst resolveConfig = (conf)=>{\n  return Object.keys(conf).map((v)=>{\n    const envs = /^@(.*)/.exec(v);\n    const cenvs = /^@(.*?):([^:]*)/.exec(v);\n    const value = (isObject(conf[v]))? \n      resolveConfig(conf[v]): \n      (isArray(conf[v]))?conf[v].map((cf)=>resolveConfig(cf))\n      :conf[v];\n    if(cenvs && cenvs[1] && cenvs[2]){\n      return {[cenvs[1]]:(process.env[cenvs[2].toUpperCase()]||value)}; \n    }else if(envs && envs[1]){\n      return {[envs[1]]:(process.env[envs[1].toUpperCase()]||value)};\n    }else{\n      return {[v]:value};\n    }\n  }).reduce((acc,curr)=>{\n    return {...acc,...curr};\n  },{});\n};\n\nconst readCommon = (dir)=>{\n  return requireWithDefault(dir+\"/./common.js\",{});\n};\n\nconst readProduction = (dir)=>{\n  return requireWithDefault(dir+\"/./production.js\",{});\n};\n\nconst readDevelopment = (dir)=>{\n  return requireWithDefault(dir+\"/./development.js\",{});\n};\n\nmodule.exports = function({dir = DEFAULT_ROOT} = {}){\n  return resolveConfig(\n    mergeConfigs(\n      readCommon(dir),\n      (process.env.NODE_ENV===\"production\")?\n        readProduction(dir):readDevelopment(dir)\n    )\n  );\n};\n"]}